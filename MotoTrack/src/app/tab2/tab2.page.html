<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>ğŸ“ Meine Routen</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">ğŸ“ Meine Routen</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Refresher -->
  <ion-refresher slot="fixed" (ionRefresh)="onRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- Jahr-Auswahl -->
  <div class="year-selector">
    <ion-button 
      *ngFor="let year of availableYears" 
      [fill]="selectedYear === year ? 'solid' : 'outline'"
      [color]="selectedYear === year ? 'primary' : 'medium'"
      (click)="onYearChange(year)"
      size="small">
      {{ year }}
    </ion-button>
  </div>

  <!-- Monat-Filter (scrollbar) -->
  <div class="month-selector">
    <ion-button 
      *ngFor="let month of months" 
      [fill]="selectedMonth === month.value ? 'solid' : 'outline'"
      [color]="selectedMonth === month.value ? 'primary' : 'medium'"
      (click)="onMonthChange(month.value)"
      size="small"
      class="month-button">
      {{ month.label }}
    </ion-button>
  </div>

  <!-- Routen-Liste -->
  <div class="tour-list">
    <!-- Leer-State: Keine Routen -->
    <div *ngIf="filteredTours.length === 0" class="empty-state">
      <ion-icon name="map-outline" size="large"></ion-icon>
      <p>Keine Routen vorhanden</p>
    </div>

    <!-- Tour-Karten -->
    <ion-card 
      *ngFor="let tour of filteredTours" 
      (click)="goToDetail(tour.id!)" 
      class="tour-card">
      
      <!-- Karte -->
      <div class="map-thumbnail">
        <div [id]="'map-' + tour.id" class="map-container"></div>
      </div>

      <!-- Tour-Informationen -->
      <div class="tour-info">
        <!-- Distanz & Dauer -->
        <div class="tour-header">
          <div class="distance-duration">
            <span class="value">{{ formatDistance(tour.distance) }}</span>
            <span class="unit">km</span>
            <span class="separator">â€¢</span>
            <span class="value">{{ formatDuration(tour.duration) }}</span>
            <span class="unit">min</span>
          </div>
          <div class="speed">
            <ion-icon name="speedometer-outline"></ion-icon>
            {{ formatSpeed(tour.avg_speed) }} km/h
          </div>
        </div>

        <!-- Start- und End-Zeit -->
        <div class="tour-times">
          <span class="time">{{ getStartTime(tour) }}</span>
          <span class="separator">â€“</span>
          <span class="time">{{ getEndTime(tour) }}</span>
        </div>

        <!-- Datum -->
        <div class="tour-date">
          {{ getFormattedDate(tour.created_at!) }}
        </div>
      </div>

      <!-- LÃ¶schen-Button (Swipe) -->
      <ion-item-options side="end">
        <ion-item-option color="danger" (click)="deleteTour(tour.id!, $event)">
          <ion-icon name="trash"></ion-icon>
          LÃ¶schen
        </ion-item-option>
      </ion-item-options>
    </ion-card>
  </div>
</ion-content>
