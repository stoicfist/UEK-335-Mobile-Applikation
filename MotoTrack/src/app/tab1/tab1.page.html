<ion-content [fullscreen]="true">
  <!-- Map Container - Full Screen -->
  <div id="map" #mapContainer></div>
  
  <!-- Search FAB Button (top left) -->
  <ion-fab vertical="top" horizontal="start" slot="fixed">
    <ion-fab-button (click)="openSearchModal()" color="light">
      <ion-icon name="search"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Recording FAB Button (bottom right) -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" class="recording-fab">
    <ion-fab-button (click)="toggleRecording()" [color]="isRecording ? 'danger' : 'primary'">
      <ion-icon [name]="isRecording ? 'square-outline' : 'radio-button-on-outline'"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Navigation FAB Button -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" class="navigation-fab">
    <ion-fab-button (click)="toggleNavigation()" [color]="isNavigating ? 'warning' : 'tertiary'">
      <ion-icon [name]="isNavigating ? 'stop-circle-outline' : 'navigate-outline'"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- My Location FAB Button (bottom right) -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed" class="location-fab">
    <ion-fab-button class="location-button" (click)="goToMyLocation()">
      <ion-icon name="locate"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Route Info Badge (if route exists) -->
  <div class="route-info-badge" *ngIf="routeInfo">
    <ion-chip color="primary">
      <ion-icon name="navigate"></ion-icon>
      <ion-label>{{ routeInfo.distance }} km · {{ routeInfo.duration }} min</ion-label>
    </ion-chip>
  </div>
</ion-content>

<!-- Search Modal -->
<ion-modal [isOpen]="isSearchModalOpen" (didDismiss)="closeSearchModal()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Route planen</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="closeSearchModal()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content>
      <ion-list>
        <ion-list-header>
          <ion-label>Start & Ziel</ion-label>
        </ion-list-header>

        <!-- Start Input -->
        <ion-item>
          <ion-icon name="location" slot="start" color="success"></ion-icon>
          <ion-input
            [(ngModel)]="startInput"
            placeholder="Startpunkt eingeben..."
            (ionInput)="onStartInput()"
            (keyup.enter)="searchStart()">
          </ion-input>
          <ion-button slot="end" fill="clear" (click)="useCurrentLocation()">
            <ion-icon name="locate" color="primary"></ion-icon>
          </ion-button>
        </ion-item>

        <!-- Destination Input -->
        <ion-item>
          <ion-icon name="flag" slot="start" color="danger"></ion-icon>
          <ion-input
            [(ngModel)]="endInput"
            placeholder="Ziel eingeben..."
            (ionInput)="onEndInput()"
            (keyup.enter)="searchEndAndCalculate()">
          </ion-input>
          <ion-button slot="end" fill="clear" (click)="searchEndAndCalculate()">
            <ion-icon name="search" color="primary"></ion-icon>
          </ion-button>
        </ion-item>

        <!-- Route Info Display -->
        <ion-item *ngIf="routeInfo" lines="none">
          <ion-label>
            <h2>Route gefunden!</h2>
            <p><strong>Distanz:</strong> {{ routeInfo.distance }} km</p>
            <p><strong>Dauer:</strong> {{ routeInfo.duration }} min</p>
          </ion-label>
        </ion-item>

        <!-- Clear Button -->
        <ion-item lines="none" *ngIf="routeInfo">
          <ion-button expand="block" color="danger" fill="outline" (click)="clearRoute()">
            <ion-icon name="close-circle" slot="start"></ion-icon>
            Route löschen
          </ion-button>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>
